# MCLocalAuth v1.2.0

**Type:** Mise à jour majeure  
**Date:** 21 Octobre 2025

---

## ✨ Nouvelles fonctionnalités

### 🔍 Commande /mctest

Une nouvelle commande Discord pour tester la connexion entre le bot et le plugin.

**Utilisation:** `/mctest`

**Affiche:**
- Statut de connexion (CONNECTÉ/DÉCONNECTÉ)
- Version du serveur Minecraft
- Version du plugin
- Nombre de joueurs en ligne
- Nombre d'authentifications en attente
- Statut du bot Discord

---

### ✅ Commande /auth simplifiée

**AVANT:**
```
/auth <pseudo> <code>
```

**MAINTENANT:**
```
/auth <code>
```

Le pseudo n'est plus nécessaire ! Le bot recherche automatiquement le joueur correspondant au code parmi tous les joueurs en attente d'authentification.

**Avantages:**
- Plus simple à utiliser
- Moins d'erreurs de frappe
- Authentification plus rapide

---

## 🔧 Corrections majeures

### 🔍 Correction: "Joueur introuvable"

**PROBLÈME RÉSOLU:** Le bot ne trouvait pas les joueurs car il cherchait uniquement parmi les joueurs authentifiés.

**SOLUTION:** Le bot cherche maintenant dans la liste des codes en attente (PendingManager) au lieu de chercher directement le joueur connecté.

**Résultat:** Le bot trouve maintenant correctement tous les joueurs qui tentent de se connecter.

---

### 🌐 Recherche étendue du code

Le système parcourt automatiquement TOUS les joueurs en ligne ayant un code en attente pour trouver la correspondance, au lieu de se limiter à un seul joueur.

---

## 🔧 Détails techniques

**Fichiers modifiés:**
- `DiscordBot.java` → Ajout de /mctest aux commandes enregistrées
- `DiscordCommandListener.java` → Nouvelle méthode handleMcTest() + handleAuth() réécrite
- `pom.xml` & `plugin.yml` → Version 1.2.0

**Algorithme de recherche (handleAuth):**
1. Validation du format du code (4-8 chiffres)
2. Vérification de l'appartenance au serveur Discord
3. Parcours de tous les joueurs en ligne
4. Pour chaque joueur: vérifier code en attente
5. Si match trouvé: consommer code + enregistrer IP + confirmer

---

## 📦 Compatibilité

✅ **Minecraft:** 1.8 → 1.21+  
✅ **Java:** 8+  
✅ **Serveur:** Spigot, Paper, Purpur  
✅ **Config:** Aucun changement requis

---

## 📋 Comparatif

### Version 1.1.0 (Précédente)
- ❌ /auth nécessitait pseudo + code
- ❌ Erreur "Joueur introuvable"
- ❌ Pas de commande de test
- ❌ Recherche limitée à un joueur

### Version 1.2.0 (Actuelle)
- ✅ /auth ne nécessite que le code
- ✅ Trouve tous les joueurs en attente
- ✅ Commande /mctest disponible
- ✅ Recherche dans tous les codes en attente
- ✅ Messages d'erreur plus clairs

---

## 🚀 Utilisation

**Pour l'utilisateur Discord:**
1. Se connecter au serveur Minecraft
2. Noter le code affiché à l'écran
3. Utiliser `/auth <code>` sur Discord
4. Attendre la confirmation
5. Jouer !

**Pour tester la connexion:**
- Utiliser `/mctest` sur Discord
- Vérifier que le statut est "CONNECTÉ"

---

## ⚙️ Installation

1. Arrêter le serveur Minecraft
2. Remplacer `MCLocalAuth-Spigot-v1.1.0.jar` par `MCLocalAuth-Spigot-v1.2.0.jar`
3. Redémarrer le serveur
4. Tester avec `/mctest` sur Discord

**Note:** La configuration (config.yml) reste identique, aucun changement requis.

---

**Taille:** 10.68 MB  
**Build:** Maven + Java 8  
**Statut:** STABLE ✅
