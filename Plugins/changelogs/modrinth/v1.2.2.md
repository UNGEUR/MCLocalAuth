# MCLocalAuth v1.2.2

**Type:** Fix critique  
**Date:** 21 Octobre 2025

---

## ğŸ› Bug critique corrigÃ©

### Code toujours invalide

**ProblÃ¨me:**
- Joueur se connecte â†’ ReÃ§oit code
- Joueur tape `/auth <code>` sur Discord
- Bot rÃ©pond: "Code invalide"
- **MÃªme avec le bon code !**

---

## ğŸ” Cause

L'ancien code cherchait dans `Bukkit.getOnlinePlayers()`

**Mais:**
- Quand joueur est kick pour auth â†’ N'est PLUS dans `getOnlinePlayers()` !
- Code existe dans `PendingManager`
- Mais joueur introuvable !

---

## âœ… Solution

### Nouvelle mÃ©thode `findByCode()`

Ajout dans `PendingManager.java`:

```java
public PendingEntry findByCode(String code) {
    cleanupExpired();
    for (PendingEntry entry : pending.values()) {
        if (entry.code.equals(code)) {
            return entry;
        }
    }
    return null;
}
```

### Modification dans `DiscordCommandListener.java`

**Avant:**
```java
for (Player onlinePlayer : Bukkit.getOnlinePlayers()) {
    if (pendingManager.isPending(...)) { ... }
}
```

**AprÃ¨s:**
```java
PendingEntry entry = pendingManager.findByCode(code);
if (entry != null) { ... }
```

---

## ğŸ‰ RÃ©sultat

L'authentification fonctionne maintenant:

1. âœ… Connexion Minecraft â†’ Code gÃ©nÃ©rÃ©
2. âœ… Kick automatique â†’ Code reste dans PendingManager
3. âœ… `/auth <code>` sur Discord â†’ Trouve le code !
4. âœ… Authentification rÃ©ussie â†’ Reconnexion autorisÃ©e

---

## ğŸ“¦ Installation

1. Remplacer par `MCLocalAuth-Spigot-v1.2.2.jar`
2. RedÃ©marrer serveur
3. Tester authentification complÃ¨te

---

**Taille:** 10.68 MB  
**Statut:** STABLE âœ…
