# MCLocalAuth v1.3.0

**Type:** Mise Ã  jour majeure  
**Date:** 22 Octobre 2025

---

## âœ¨ NouveautÃ©s

### ğŸ® Commande Discord renommÃ©e

**Nouvelle commande:** `/mclogin <code>`  
**Ancienne commande:** `/auth <code>`

Tous les messages et rÃ©fÃ©rences ont Ã©tÃ© mis Ã  jour pour utiliser `/mclogin`.

**Exemple d'utilisation:**
```
/mclogin 123456
```

---

### ğŸ”“ Commande /unlink (Admin)

Nouvelle commande rÃ©servÃ©e aux administrateurs pour dÃ©lier un compte Discord.

**Utilisation:** `/unlink <discord_id>`

**Permissions:**
- RÃ©servÃ© Ã  l'admin configurÃ© dans `config.yml` (`admin.discord_id`)
- Journalise toutes les tentatives dans les logs

**Note:** FonctionnalitÃ© de base implÃ©mentÃ©e. L'implÃ©mentation complÃ¨te avec liaison Discord persistante arrive prochainement.

---

## ğŸ”§ Corrections

### ğŸ“ Encodage UTF-8 corrigÃ© (in-game)

**ProblÃ¨me rÃ©solu:** Messages in-game avec caractÃ¨res bizarres

**Avant:**
```
[MCLocalAuth] PvP_UNGEUR a rÃ©initialisÃ© les IP de PvP_UNGEUR
                           ^^^^^^^^^^^^^^^^^^
```

**AprÃ¨s:**
```
[MCLocalAuth] PvP_UNGEUR a reinitialise les IP de PvP_UNGEUR
```

**Tous les messages corrigÃ©s:**
- "rÃ©initialisÃ©" â†’ "reinitialise"
- "ajoutÃ©" â†’ "ajoute"
- "supprimÃ©" â†’ "supprime"
- "dÃ©fini" â†’ "defini"
- "autorisÃ©es" â†’ "autorisees"

---

### ğŸŒ Support IPv6

Les adresses IPv6 sont maintenant acceptÃ©es pour les IP autorisÃ©es !

**Avant:** Seules les IPv4 Ã©taient validÃ©es (ex: `192.168.1.1`)  
**AprÃ¨s:** IPv4 ET IPv6 supportÃ©es (ex: `2001:0db8:85a3::8a2e:0370:7334`)

**Commandes affectÃ©es:**
- `/auth addip <joueur> <ip>`
- `/auth setip <joueur> <ip>`

La validation utilise maintenant `InetAddress.getByName()` pour supporter les deux formats.

---

### ğŸ” IP actuelle affichÃ©e dans kick

Quand un joueur est kick pour mauvaise IP, le message affiche maintenant son IP actuelle.

**Message de kick:**
```
Â§cConnexion refusee: Votre IP n'est pas autorisee pour ce compte.

Â§7Votre IP: Â§f123.45.67.89

Â§eContactez un administrateur si vous jouez depuis un nouvel endroit.
```

La variable `%current_ip%` est maintenant correctement remplacÃ©e dans `config.yml`.

---

## ğŸ“¦ Modifications techniques

### Fichiers modifiÃ©s

**Java:**
- `AuthAdminCommand.java` - Encodage + validation IPv6
- `LoginListener.java` - Affichage IP actuelle + encodage
- `DiscordBot.java` - Renommage /auth â†’ /mclogin
- `DiscordCommandListener.java` - Handler /mclogin + /unlink admin

**Configuration:**
- `config.yml` - Messages sans accents + `/mclogin`
- `plugin.yml` - Version 1.3.0
- `pom.xml` - Version 1.3.0

---

## ğŸ”„ Migration depuis v1.2.x

**Ã‰tapes:**

1. **ArrÃªter le serveur**
2. **Remplacer** le JAR par `MCLocalAuth-Spigot-v1.3.0.jar`
3. **Configurer admin** (nouveau) dans `config.yml`:
   ```yaml
   admin:
     discord_id: "TON_DISCORD_ID"  # Pour /unlink
     minecraft_uuid: ""              # Optionnel
   ```
4. **RedÃ©marrer le serveur**
5. **Informer les joueurs** : La commande est maintenant `/mclogin <code>`

**Note:** L'ancienne configuration reste compatible. Les messages seront automatiquement mis Ã  jour.

---

## ğŸ“‹ Changements visibles pour les joueurs

### Sur Discord

**Avant:**
```
/auth 123456
```

**Maintenant:**
```
/mclogin 123456
```

### Dans Minecraft

**Message de connexion:**
```
Sur Discord, tapez: /mclogin 870600
```
(au lieu de `/auth PvP_UNGEUR 870600`)

---

## ğŸ›¡ï¸ SÃ©curitÃ©

### Logging administrateur

Toutes les actions admin sont maintenant loggÃ©es:

```
[ADMIN] PvP_UNGEUR#1234 a tente de delier le Discord ID: 987654321
```

Utile pour auditer les actions sensibles.

---

## ğŸ“Š CompatibilitÃ©

âœ… **Minecraft:** 1.8 â†’ 1.21+  
âœ… **Java:** 8+  
âœ… **IPv4 & IPv6:** SupportÃ©s  
âœ… **Config:** Compatible v1.2.x (ajout automatique section admin)

---

## ğŸ› Bugs connus

Aucun bug connu Ã  ce jour.

**Si vous rencontrez un problÃ¨me:**
1. VÃ©rifiez que vous utilisez v1.3.0
2. VÃ©rifiez les logs du serveur
3. Ouvrez une issue sur GitHub

---

## ğŸ’¡ Commandes Discord (mise Ã  jour)

| Commande | Description | Permissions |
|----------|-------------|-------------|
| `/mclogin <code>` | S'authentifier avec le code | Tous |
| `/mctest` | Tester connexion bot/plugin | Tous |
| `/status` | VÃ©rifier son statut | Tous |
| `/unlink <discord_id>` | DÃ©lier un compte | **Admin uniquement** |

---

## âš™ï¸ Installation

1. TÃ©lÃ©charger `MCLocalAuth-Spigot-v1.3.0.jar`
2. Placer dans `plugins/`
3. RedÃ©marrer le serveur
4. Configurer `admin.discord_id` dans `config.yml`
5. Tester avec `/mctest` et `/mclogin`

---

**Taille:** 10.68 MB  
**Build:** Maven 3.9.5 + Java 8  
**Statut:** STABLE âœ…
